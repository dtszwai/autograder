import{I as Ie,m as _e}from"./manifest-D274No9N.js";import{c as Q,r as c,j as e,B as A,R as Pe,a1 as Ee,f as D,o as _,q as Z,P as w,g as $,s as Le,u as B,W as Oe,m as Te,d as j,n as Me,e as R,a0 as De,G as $e,H as Be,a as Ge}from"./createLucideIcon-DCR3vvNf.js";import{k as ee,c as k,d as ze,b as He,x as Ue,y as Fe,n as Ve,T as X,s as Ke}from"./canvasApi-B3XcU1Pv.js";import{p as qe}from"./request-Bv5M4Dhc.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=Q("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=Q("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Xe=()=>{const[t,n]=c.useState(!1),s=()=>{chrome.runtime.openOptionsPage()},o=async()=>{n(!0),await chrome.runtime.sendMessage({type:ee}),n(!1)};return e.jsxs("header",{className:"flex items-center justify-between p-4 bg-white border-b border-zinc-200 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:Ie,alt:"Icon",className:"w-6 h-6 mr-2"}),e.jsx("span",{className:"text-lg font-bold text-gray-800",children:_e.name})]}),e.jsxs("div",{className:"gap-1",children:[e.jsx(A,{onClick:o,"aria-label":"Refresh",variant:"ghost",size:"icon",className:"size-8",disabled:t,children:e.jsx(Pe,{className:"size-3 animate-spin",style:{animationPlayState:t?"running":"paused"}})}),e.jsx(A,{onClick:s,"aria-label":"Settings",variant:"ghost",size:"icon",className:"size-8",children:e.jsx(Ee,{className:"size-3"})})]})]})};var G="Collapsible",[Ye,te]=D(G),[Qe,z]=Ye(G),se=c.forwardRef((t,n)=>{const{__scopeCollapsible:s,open:o,defaultOpen:r,disabled:a,onOpenChange:i,...l}=t,[u=!1,f]=_({prop:o,defaultProp:r,onChange:i});return e.jsx(Qe,{scope:s,disabled:a,contentId:Z(),open:u,onOpenToggle:c.useCallback(()=>f(g=>!g),[f]),children:e.jsx(w.div,{"data-state":U(u),"data-disabled":a?"":void 0,...l,ref:n})})});se.displayName=G;var ne="CollapsibleTrigger",oe=c.forwardRef((t,n)=>{const{__scopeCollapsible:s,...o}=t,r=z(ne,s);return e.jsx(w.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":U(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...o,ref:n,onClick:$(t.onClick,r.onOpenToggle)})});oe.displayName=ne;var H="CollapsibleContent",ae=c.forwardRef((t,n)=>{const{forceMount:s,...o}=t,r=z(H,t.__scopeCollapsible);return e.jsx(Le,{present:s||r.open,children:({present:a})=>e.jsx(Ze,{...o,ref:n,present:a})})});ae.displayName=H;var Ze=c.forwardRef((t,n)=>{const{__scopeCollapsible:s,present:o,children:r,...a}=t,i=z(H,s),[l,u]=c.useState(o),f=c.useRef(null),g=B(n,f),m=c.useRef(0),b=m.current,v=c.useRef(0),p=v.current,d=i.open||l,C=c.useRef(d),x=c.useRef();return c.useEffect(()=>{const h=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(h)},[]),Oe(()=>{const h=f.current;if(h){x.current=x.current||{transitionDuration:h.style.transitionDuration,animationName:h.style.animationName},h.style.transitionDuration="0s",h.style.animationName="none";const y=h.getBoundingClientRect();m.current=y.height,v.current=y.width,C.current||(h.style.transitionDuration=x.current.transitionDuration,h.style.animationName=x.current.animationName),u(o)}},[i.open,o]),e.jsx(w.div,{"data-state":U(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!d,...a,ref:g,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":p?`${p}px`:void 0,...t.style},children:d&&r})});function U(t){return t?"open":"closed"}var et=se,tt=oe,st=ae,N="Accordion",nt=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[F,ot,at]=Te(N),[P,It]=D(N,[at,te]),V=te(),re=j.forwardRef((t,n)=>{const{type:s,...o}=t,r=o,a=o;return e.jsx(F.Provider,{scope:t.__scopeAccordion,children:s==="multiple"?e.jsx(lt,{...a,ref:n}):e.jsx(ct,{...r,ref:n})})});re.displayName=N;var[ie,rt]=P(N),[ce,it]=P(N,{collapsible:!1}),ct=j.forwardRef((t,n)=>{const{value:s,defaultValue:o,onValueChange:r=()=>{},collapsible:a=!1,...i}=t,[l,u]=_({prop:s,defaultProp:o,onChange:r});return e.jsx(ie,{scope:t.__scopeAccordion,value:l?[l]:[],onItemOpen:u,onItemClose:j.useCallback(()=>a&&u(""),[a,u]),children:e.jsx(ce,{scope:t.__scopeAccordion,collapsible:a,children:e.jsx(le,{...i,ref:n})})})}),lt=j.forwardRef((t,n)=>{const{value:s,defaultValue:o,onValueChange:r=()=>{},...a}=t,[i=[],l]=_({prop:s,defaultProp:o,onChange:r}),u=j.useCallback(g=>l((m=[])=>[...m,g]),[l]),f=j.useCallback(g=>l((m=[])=>m.filter(b=>b!==g)),[l]);return e.jsx(ie,{scope:t.__scopeAccordion,value:i,onItemOpen:u,onItemClose:f,children:e.jsx(ce,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(le,{...a,ref:n})})})}),[dt,E]=P(N),le=j.forwardRef((t,n)=>{const{__scopeAccordion:s,disabled:o,dir:r,orientation:a="vertical",...i}=t,l=j.useRef(null),u=B(l,n),f=ot(s),m=Me(r)==="ltr",b=$(t.onKeyDown,v=>{var W;if(!nt.includes(v.key))return;const p=v.target,d=f().filter(T=>{var J;return!((J=T.ref.current)!=null&&J.disabled)}),C=d.findIndex(T=>T.ref.current===p),x=d.length;if(C===-1)return;v.preventDefault();let h=C;const y=0,S=x-1,L=()=>{h=C+1,h>S&&(h=y)},O=()=>{h=C-1,h<y&&(h=S)};switch(v.key){case"Home":h=y;break;case"End":h=S;break;case"ArrowRight":a==="horizontal"&&(m?L():O());break;case"ArrowDown":a==="vertical"&&L();break;case"ArrowLeft":a==="horizontal"&&(m?O():L());break;case"ArrowUp":a==="vertical"&&O();break}const Re=h%x;(W=d[Re].ref.current)==null||W.focus()});return e.jsx(dt,{scope:s,disabled:o,direction:r,orientation:a,children:e.jsx(F.Slot,{scope:s,children:e.jsx(w.div,{...i,"data-orientation":a,ref:u,onKeyDown:o?void 0:b})})})}),I="AccordionItem",[ut,K]=P(I),de=j.forwardRef((t,n)=>{const{__scopeAccordion:s,value:o,...r}=t,a=E(I,s),i=rt(I,s),l=V(s),u=Z(),f=o&&i.value.includes(o)||!1,g=a.disabled||t.disabled;return e.jsx(ut,{scope:s,open:f,disabled:g,triggerId:u,children:e.jsx(et,{"data-orientation":a.orientation,"data-state":xe(f),...l,...r,ref:n,disabled:g,open:f,onOpenChange:m=>{m?i.onItemOpen(o):i.onItemClose(o)}})})});de.displayName=I;var ue="AccordionHeader",pe=j.forwardRef((t,n)=>{const{__scopeAccordion:s,...o}=t,r=E(N,s),a=K(ue,s);return e.jsx(w.h3,{"data-orientation":r.orientation,"data-state":xe(a.open),"data-disabled":a.disabled?"":void 0,...o,ref:n})});pe.displayName=ue;var M="AccordionTrigger",me=j.forwardRef((t,n)=>{const{__scopeAccordion:s,...o}=t,r=E(N,s),a=K(M,s),i=it(M,s),l=V(s);return e.jsx(F.ItemSlot,{scope:s,children:e.jsx(tt,{"aria-disabled":a.open&&!i.collapsible||void 0,"data-orientation":r.orientation,id:a.triggerId,...l,...o,ref:n})})});me.displayName=M;var fe="AccordionContent",he=j.forwardRef((t,n)=>{const{__scopeAccordion:s,...o}=t,r=E(N,s),a=K(fe,s),i=V(s);return e.jsx(st,{role:"region","aria-labelledby":a.triggerId,"data-orientation":r.orientation,...i,...o,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});he.displayName=fe;function xe(t){return t?"open":"closed"}var pt=re,mt=de,ft=pe,ge=me,be=he;const ht=pt,ve=c.forwardRef(({className:t,...n},s)=>e.jsx(mt,{ref:s,className:t,...n}));ve.displayName="AccordionItem";const Ce=c.forwardRef(({className:t,children:n,...s},o)=>e.jsx(ft,{className:"flex",children:e.jsxs(ge,{ref:o,className:R("flex flex-1 items-center gap-2 px-2 py-4 text-sm font-medium transition-all hover:bg-slate-100 [&[data-state=open]>svg]:rotate-180",t),...s,children:[e.jsx(De,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"}),n]})}));Ce.displayName=ge.displayName;const je=c.forwardRef(({className:t,children:n,...s},o)=>e.jsx(be,{ref:o,className:"pl-4 overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...s,children:e.jsx("div",{className:R("px-2",t),children:n})}));je.displayName=be.displayName;function Y({course:t,assignment:n,onBack:s}){const[o,r]=c.useState(""),[a,i]=c.useState(!1),[l,u]=c.useState(!1);c.useEffect(()=>{(async()=>{const b=await k("settings");if(!b)return;const{baseURL:v}=b;r(v)})()},[]);const f=c.useCallback(async()=>{chrome.tabs.create({url:`${o}/courses/${t.id}/assignments/${n.id}`})},[o,t,n]),g=async()=>{try{i(!0);const m=await k(ze);if(!m)throw new Error("User settings not found");const b=await He(t.id,n.id);await qe({course:t,assignment:n,submissions:b,settings:m.evaluation}),u(!0)}catch{u(!1)}finally{i(!1)}};return e.jsxs("div",{className:"p-4",children:[e.jsx("button",{onClick:s,className:"text-blue-600 hover:underline mb-4",children:"← Back"}),e.jsx("h2",{className:"text-xl font-semibold mb-2 hover:underline cursor-pointer",onClick:f,children:n.name}),e.jsx("div",{className:"mb-4 text-sm font-medium",children:e.jsx(A,{variant:"link",className:"text-wrap px-0 text-left",onClick:()=>{chrome.tabs.create({url:`${o}/courses/${t.id}`})},children:t.name})}),e.jsx("div",{className:"mb-6 text-sm",children:e.jsxs("p",{className:"font-medium",children:["Needs Grading: ",n.needs_grading_count]})}),e.jsx(A,{onClick:f,className:"w-full my-3",variant:"outline",children:"View in Canvas"}),e.jsx(A,{onClick:g,className:"w-full flex items-center justify-center",disabled:a||l,children:a?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}),"Autograding..."]}):l?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"mr-2 h-4 w-4 text-green-500"}),"Requested Successfully"]}):"Autograde"})]})}function xt(){const[t,n]=c.useState([]),[s,o]=c.useState(!1),[r,a]=c.useState({}),[i,l]=c.useState(null),u=c.useCallback(async()=>{o(!0),Promise.all([k(Ue),k(Fe)]).then(([p,d])=>{n(p||[]),a(d||{})}).finally(()=>o(!1))},[]);c.useEffect(()=>{u();const p=async d=>{d.type===ee&&await u()};return chrome.runtime.onMessage.addListener(p),()=>chrome.runtime.onMessage.removeListener(p)},[u]);const f=(p,d)=>{l({course:p,assignment:d})},g=()=>{l(null)},m=c.useMemo(()=>[...t].sort((p,d)=>(d.needs_grading_count||0)-(p.needs_grading_count||0)),[t]);if(i)return e.jsx(Y,{course:i.course,assignment:i.assignment,onBack:g});const b=()=>{if(!i)return null;const{course:p,assignment:d}=i;return e.jsx(Y,{course:p,assignment:d,onBack:g})},v=(p,d)=>{const C=d.filter(x=>x.needs_grading_count&&x.needs_grading_count>0);return C.length===0?e.jsx("p",{className:"text-gray-500 p-2 text-xs",children:"No assignments need grading in this course."}):e.jsx("ul",{className:"text-xs",children:C.map(x=>e.jsx("li",{className:"p-2 hover:bg-gray-50 cursor-pointer",onClick:()=>f(p,x),children:e.jsxs("p",{children:[x.name,e.jsx("br",{}),e.jsxs("span",{className:"text-gray-500",children:["(",x.needs_grading_count," ",x.needs_grading_count===1?"ungraded submission":"ungraded submissions",")"]})]})},x.id))})};return i?b():s?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("p",{className:"text-gray-500",children:"Loading data..."})}):t.length?e.jsx("div",{className:"overflow-y-auto h-96",children:e.jsx(ht,{type:"single",collapsible:!0,children:m.map(p=>{const d=r[p.id]||[];return e.jsxs(ve,{value:p.id.toString(),children:[e.jsx(Ce,{className:"text-left text-xs font-bold",children:e.jsxs("p",{children:[p.name,e.jsx("br",{}),d.length>0&&e.jsxs("span",{className:"text-gray-500",children:["(",d.length," ",d.length===1?"assignment":"assignments",")"]})]})}),e.jsx(je,{children:v(p,d)})]},p.id)})})}):e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("p",{className:"text-gray-500",children:"No active courses found."})})}var q="Switch",[gt,_t]=D(q),[bt,vt]=gt(q),ye=c.forwardRef((t,n)=>{const{__scopeSwitch:s,name:o,checked:r,defaultChecked:a,required:i,disabled:l,value:u="on",onCheckedChange:f,form:g,...m}=t,[b,v]=c.useState(null),p=B(n,y=>v(y)),d=c.useRef(!1),C=b?g||!!b.closest("form"):!0,[x=!1,h]=_({prop:r,defaultProp:a,onChange:f});return e.jsxs(bt,{scope:s,checked:x,disabled:l,children:[e.jsx(w.button,{type:"button",role:"switch","aria-checked":x,"aria-required":i,"data-state":Ae(x),"data-disabled":l?"":void 0,disabled:l,value:u,...m,ref:p,onClick:$(t.onClick,y=>{h(S=>!S),C&&(d.current=y.isPropagationStopped(),d.current||y.stopPropagation())})}),C&&e.jsx(Ct,{control:b,bubbles:!d.current,name:o,value:u,checked:x,required:i,disabled:l,form:g,style:{transform:"translateX(-100%)"}})]})});ye.displayName=q;var Ne="SwitchThumb",we=c.forwardRef((t,n)=>{const{__scopeSwitch:s,...o}=t,r=vt(Ne,s);return e.jsx(w.span,{"data-state":Ae(r.checked),"data-disabled":r.disabled?"":void 0,...o,ref:n})});we.displayName=Ne;var Ct=t=>{const{control:n,checked:s,bubbles:o=!0,...r}=t,a=c.useRef(null),i=$e(s),l=Be(n);return c.useEffect(()=>{const u=a.current,f=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(f,"checked").set;if(i!==s&&m){const b=new Event("click",{bubbles:o});m.call(u,s),u.dispatchEvent(b)}},[i,s,o]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...r,tabIndex:-1,ref:a,style:{...t.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Ae(t){return t?"checked":"unchecked"}var ke=ye,jt=we;const Se=c.forwardRef(({className:t,...n},s)=>e.jsx(ke,{className:R("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...n,ref:s,children:e.jsx(jt,{className:R("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Se.displayName=ke.displayName;const yt=({enableOnSite:t,handleToggle:n})=>e.jsxs("div",{className:"flex px-2 py-3 gap-2 items-center border-t border-zinc-200",children:[e.jsx(Se,{onCheckedChange:n,checked:t}),e.jsx("p",{className:"text-sm text-[#4b4b4b]",children:"Enable on site"})]}),Nt=()=>{const[t,n]=c.useState(!1),[s,o]=c.useState(!1),[r,a]=c.useState(!0);c.useEffect(()=>{k(Ve).then(()=>n(!0)),k(X).then(l=>l&&o(l)),a(!1)},[]);const i=async l=>{await Ke(X,l),o(l)};return r?e.jsx("div",{className:"flex items-center justify-center w-72 h-96",children:"Loading..."}):t?e.jsxs("div",{className:"w-72",children:[e.jsx(Xe,{}),e.jsx(xt,{}),e.jsx(yt,{enableOnSite:s,handleToggle:i})]}):e.jsxs("div",{className:"w-72 p-4",children:[e.jsx("h1",{className:"text-xl font-bold mb-2",children:"FeedbackAI"}),e.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"Please set your API token and base URL in the settings to continue."}),e.jsx(A,{onClick:()=>chrome.runtime.openOptionsPage(),children:"Open Settings"})]})};function wt(){const t=document.querySelector("#__root");if(!t)throw new Error("Can't find Popup root element");Ge(t).render(e.jsx(Nt,{}))}wt();
